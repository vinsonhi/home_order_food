# 云开发 quickstart

这是云开发的快速启动指引，其中演示了如何上手使用云开发的三大基础能力：

- 数据库：一个既可在小程序前端操作，也能在云函数中读写的 JSON 文档型数据库
- 文件存储：在小程序前端直接上传/下载云端文件，在云开发控制台可视化管理
- 云函数：在云端运行的代码，微信私有协议天然鉴权，开发者只需编写业务逻辑代码

## 参考文档

- [云开发文档](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/getting-started.html)

# 私房菜单小程序

这是一个家庭使用的点餐应用，用于家庭成员（主要是老婆）向家庭厨师（主要是老公）点餐。

## 项目结构

```
miniprogram-1/
├── miniprogram/           // 小程序主目录
│   ├── pages/             // 基础页面
│   ├── packageA/          // 分包目录
│   ├── images/            // 图片资源
│   │   ├── smaller/       // 压缩后的图片
│   ├── data/              // 数据文件
│   ├── app.js             // 小程序入口文件
│   └── app.json           // 小程序配置文件
├── cloudfunctions/        // 云函数目录
│   └── quickstartFunctions/ // 云函数集合
└── test/                  // 测试目录
    ├── pages/             // 页面测试
    ├── packageA/          // 分包页面测试
    ├── cloudfunctions/    // 云函数测试
    ├── helper.js          // 测试辅助函数
    └── run-tests.sh       // 测试运行脚本
```

## 主要功能

- 菜单浏览：用户可以浏览菜品分类和菜品列表
- 购物车管理：用户可以添加菜品到购物车，并管理购物车中的菜品
- 订单提交：用户可以提交订单，并添加备注
- 订单通知：通过微信订阅消息通知接单方（老公）

## 开发指南

### 安装依赖

```bash
npm install
```

### 云函数部署

1. 使用微信开发者工具打开项目
2. 点击云开发按钮
3. 上传并部署云函数

## 测试指南

本项目使用Jest进行自动化测试，确保核心功能正常运行。

### 运行测试

```bash
# 运行所有测试
npm test

# 运行单个测试文件
npx jest test/pages/index.test.js

# 生成测试覆盖率报告
npm run test:coverage
```

### 测试脚本

也可以使用提供的测试脚本运行所有测试：

```bash
./test/run-tests.sh
```

### 测试内容

测试涵盖了以下核心功能：

1. **菜单页面测试**：
   - 分类加载和切换
   - 菜品显示
   - 购物车添加功能

2. **购物车页面测试**：
   - 购物车数据显示
   - 菜品数量修改
   - 订单提交和消息订阅

3. **云函数测试**：
   - 订单通知发送
   - 订单号生成

## 如何扩展测试

1. 在对应测试目录下创建新的测试文件
2. 使用Jest的`describe`和`test`函数定义测试用例
3. 使用helper.js中提供的辅助函数模拟小程序环境
4. 运行测试脚本验证测试结果

## 开发注意事项

1. 每次修改核心功能后，请运行测试确保没有破坏现有功能
2. 添加新功能时，请同时添加对应的测试用例
3. 保持测试覆盖率在较高水平，确保代码质量

## 贡献指南

1. Fork本仓库
2. 创建功能分支
3. 提交更改
4. 创建Pull Request

## 授权协议

本项目仅供学习使用，未经允许不得用于商业用途。

