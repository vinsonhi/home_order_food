# 私房菜单小程序需求文档

## 一、项目概述

私房菜单小程序是一个家庭使用的点餐应用，用于家庭成员（主要是老婆）向家庭厨师（主要是老公）点餐。通过这个小程序，可以简化家庭用餐的沟通过程，提升家庭生活质量。

## 二、用户角色

1. **老婆**（点餐方）
   - 浏览菜单
   - 选择菜品加入购物车
   - 填写备注信息
   - 提交订单

2. **老公**（接单方）
   - 接收订单通知
   - 查看订单详情
   - 准备餐食

## 三、功能需求

### 1. 菜单页面

- 左右分栏布局：
  - 左侧：菜品分类导航栏
  - 右侧：对应分类的菜品列表
- 菜品展示内容：
  - 菜品图片
  - 菜品名称（简洁展示，不显示描述文字）
  - 加入购物车按钮
- 页面交互：
  - 点击左侧分类，右侧滚动到对应分类区域
  - 右侧滚动时，左侧分类高亮状态随之变化
  - 点击加入购物车，菜品添加到购物车，并有数量显示
- 购物车入口：
  - 悬浮在页面右下角
  - 圆形按钮
  - 显示当前购物车中的菜品数量

### 2. 购物车/下单页面

- 购物车列表：
  - 已选菜品及数量展示
  - 菜品数量增减功能
  - 清空购物车功能
- 备注信息：
  - 文本输入框
  - 可输入特殊烹饪要求
- 下单按钮：
  - 点击后生成订单
  - 发送通知给老公

### 3. 订单成功页面

- 展示订单信息
- "返回首页"按钮：点击后使用 reLaunch 方式返回到点菜首页

### 4. 通知功能

- 订单生成后，通过微信消息通知老公
- 通知内容包括：
  - 订单中的菜品列表
  - 备注信息
  - 下单时间

## 四、UI设计要求

- 整体风格：
  - 时尚现代
  - 少女化配色（粉色系为主）
  - 参考美团外卖的界面布局
- 菜单页面：
  - 分类栏使用简约风格
  - 菜品卡片设计精美
  - 图片展示优先
- 购物车页面：
  - 简洁明了
  - 突出下单按钮
  - 友好的表单交互

## 五、技术实现方案

### 1. 项目结构概述

```
miniprogram-1/
├── miniprogram/           // 小程序主目录
│   ├── pages/             // 基础页面
│   ├── packageA/          // 分包目录
│   ├── images/            // 图片资源
│   │   ├── smaller/       // 压缩后的图片
│   ├── data/              // 数据文件
│   ├── app.js             // 小程序入口文件
│   └── app.json           // 小程序配置文件
└── cloudfunctions/        // 云函数目录
    └── quickstartFunctions/ // 云函数集合
```

### 2. 数据管理

与原需求不同，当前项目使用本地JSON数据文件而非云数据库：

```
// 菜品分类数据
data/categories.js

// 菜品数据
data/dishes.js
```

### 3. 页面结构

- **首页/菜单页**: `/miniprogram/pages/index/index`
- **购物车页面**: `/miniprogram/packageA/pages/cart/cart`
- **订单成功页面**: `/miniprogram/pages/order-success/order-success`
- **管理员订单页面**: `/miniprogram/pages/admin/orders/index`

### 4. 订单通知方案

使用微信订阅消息实现，通过云函数发送通知给管理员（老公）。

## 重要文件目录解析

### 1. 主要页面文件

#### `/miniprogram/pages/index/index`
- **作用**: 菜单主页，显示菜品分类和菜品列表
- **核心文件**:
  - `index.js`: 处理菜单数据加载、左右联动、添加购物车等逻辑
  - `index.wxml`: 页面布局，包含左侧分类栏和右侧菜品展示
  - `index.wxss`: 页面样式

#### `/miniprogram/packageA/pages/cart/cart`
- **作用**: 购物车和订单提交页面
- **核心文件**:
  - `cart.js`: 处理购物车数据、提交订单、请求订阅消息等功能
  - `cart.wxml`: 购物车界面，展示所选菜品和备注框
  - `cart.wxss`: 购物车页面样式

#### `/miniprogram/pages/order-success/order-success`
- **作用**: 订单提交成功页面
- **核心文件**:
  - `order-success.js`: 显示订单信息，处理返回首页逻辑
  - `order-success.wxml`: 成功页面布局
  - `order-success.wxss`: 成功页面样式

#### `/miniprogram/pages/admin/orders/index`
- **作用**: 管理员订单管理页面
- **核心文件**:
  - `index.js`: 处理订单列表加载和状态更新
  - `index.wxml`: 订单管理界面
  - `index.wxss`: 管理页面样式

### 2. 数据文件

#### `/miniprogram/data/categories.js`
- **作用**: 存储菜品分类数据
- **数据结构**: 包含分类ID、名称、图标和排序信息

#### `/miniprogram/data/dishes.js`
- **作用**: 存储菜品数据
- **数据结构**: 包含菜品ID、分类ID、名称、图片路径等信息

### 3. 云函数

#### `/cloudfunctions/quickstartFunctions/`
- **作用**: 包含所有云函数
- **主要文件**:
  - `index.js`: 云函数入口，路由到不同功能
  - `sendOrderNotification/index.js`: 处理订单通知发送
  - `getOpenId/index.js`: 获取用户OpenID的函数

### 4. 配置文件

#### `/miniprogram/app.json`
- **作用**: 小程序全局配置
- **主要配置**: 页面路径、窗口样式、底部标签栏等

#### `/miniprogram/app.js`
- **作用**: 小程序入口文件
- **主要功能**: 初始化全局数据，包括购物车、用户信息等

## 订单通知功能详解

### 工作流程

1. 用户在购物车页面提交订单
2. 调用`wx.requestSubscribeMessage`请求订阅消息授权
3. 调用云函数`sendOrderNotification`
4. 云函数发送订阅消息给管理员（使用固定OpenID）
5. 跳转到订单成功页面

### 关键代码位置

1. **购物车提交订单**:
   `/miniprogram/packageA/pages/cart/cart.js` 中的 `submitOrder` 函数

2. **订单通知发送**:
   `/cloudfunctions/quickstartFunctions/sendOrderNotification/index.js`

3. **订阅消息模板ID**:
   模板ID 设置在 `cart.js` 文件的 `submitOrder` 函数中

## 如何修改

### 1. 修改菜品数据

编辑 `/miniprogram/data/dishes.js` 和 `/miniprogram/data/categories.js` 文件

### 2. 修改订阅消息模板

1. 在 `/miniprogram/packageA/pages/cart/cart.js` 的 `submitOrder` 函数中更新模板ID
2. 确保云函数中发送的字段与模板匹配

### 3. 修改界面样式

编辑对应页面的 `.wxss` 文件，如修改菜单页样式编辑 `/miniprogram/pages/index/index.wxss`

### 4. 修改订单通知接收者

在云函数 `/cloudfunctions/quickstartFunctions/sendOrderNotification/index.js` 中更新接收者OpenID


## 六、项目实施计划

1. **基础框架搭建**
   - 创建页面文件
   - 设置基本导航

2. **数据库设计与实现**
   - 创建云数据库集合
   - 导入初始数据

3. **UI组件开发**
   - 分类导航组件
   - 菜品卡片组件
   - 购物车组件

4. **核心功能实现**
   - 菜单展示功能
   - 购物车管理
   - 下单功能

5. **通知功能实现**
   - 配置订阅消息
   - 实现云函数

6. **测试与优化**
   - 功能测试
   - 性能优化
   - UI调整

7. **上线部署**
   - 提交审核
   - 正式发布 

## 附录：菜单分类与菜品列表

### 菜品分类

1. **大鸡大利** - 鸡肉类菜品
2. **牛气冲天** - 牛肉类菜品
3. **鱼鱼得水** - 鱼类菜品
4. **猪猪快来** - 猪肉类菜品
5. **挚爱甜品** - 甜点类
6. **海鲜** - 海鲜类菜品
7. **健康素菜** - 素食类菜品
8. **其他** - 其他类型菜品

### 菜品列表

#### 大鸡大利
- **姜葱炒鸡** - 鲜香可口，姜香浓郁
- **鲜啫鸡** - 鲜嫩多汁，味道鲜美
- **虫草花蒸鸡** - 滋补养生，鸡肉鲜嫩
- **照烧汁鸡腿肉** - 甜咸适中，鸡肉多汁
- **瑞世鸡翅** - 外脆里嫩，香气四溢

#### 牛气冲天
- **小炒黄牛肉** - 牛肉鲜嫩，口感佳
- **香煎牛扒** - 外焦里嫩，香气四溢
- **黑椒牛仔骨** - 黑椒香浓，肉质鲜嫩

#### 鱼鱼得水
- **酸菜鱼** - 酸辣开胃，鱼肉鲜嫩
- **清蒸鱼** - 鲜香嫩滑，原汁原味
- **生炒鱼片** - 鱼片鲜嫩，调味鲜美
- **砂锅鱼头** - 鲜香浓郁，营养丰富

#### 猪猪快来
- **辣椒炒肉** - 香辣可口，下饭神器
- **烤五花肉** - 外酥里嫩，肥而不腻
- **可乐排骨** - 甜香入味，肉质酥烂
- **胡萝卜炒肉** - 口感脆爽，营养均衡

#### 挚爱甜品
- **番薯糖水** - 甜而不腻，暖胃舒心
- **椰汁西米露** - 香甜顺滑，口感丰富
- **拔丝地瓜** - 外脆内软，香甜可口

#### 海鲜
- **香辣小龙虾** - 麻辣鲜香，回味无穷
- **姜葱炒蟹** - 鲜香四溢，蟹肉甘甜
- **啫鲜鱿** - 鲜嫩爽滑，口感弹牙
- **爆炒鱿鱼** - 香辣入味，爽口开胃
- **蒜蓉粉丝开边虾** - 蒜香浓郁，虾肉鲜嫩
- **香辣虾** - 麻辣鲜香，虾肉爽弹
- **蒜蓉烤生蚝** - 蒜香四溢，鲜嫩多汁 